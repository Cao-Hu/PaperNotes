# 【论文阅读】Improving Dialog Systems for Negotiation with Personality Modeling

ACL 2021

利用个性建模改进谈判对话系统（心智理论，Theory of Mind）

论文链接：https://aclanthology.org/2021.acl-long.56.pdf

## 1. 简介

背景：开发用于谈判的对话系统具有挑战性，因为这项任务需要良好的沟通技巧和战略推理能力的结合。 虽然最近的神经模型表明可以从离线语料库中学习有用的对话策略，但它们并没有明确模拟其他智能体的心理状态，这使得为不同类型的对手生成量身定制的策略和话语变得具有挑战性。

人类在与他人谈判时，会先天地推断出对方的意图，并猜测自己的话语会如何影响对方的心理状态。 为了在机器中模拟这种能力，我们训练了一个一阶 ToM 模型，以根据当前状态和代理自己可能的话语来预测对手的反应。 然后可以将此一阶 ToM 模型合并到对话代理中，以在推理过程中启用一步前瞻。

为了预测未来的反应，我们将对手的性格类型建模为中间变量 (z)，可以使用对话历史进行预测。 我们使用这个预测的个性以及之前的状态和话语来计算我们的代理在当前状态下可以采取的所有可能动作的对手下一个状态的可能性。 这允许我们计算每个动作的预期回报值，随后用于为我们的代理生成策略。 我们提出了基于 ToM 的对话代理的两种变体 - 将对手类型输出为中间预测的**显式**版本，以及将对手类型建模为潜在变量的**隐式**版本。 这两种模型都可以实例化为端到端神经网络，并且可以使用强化学习进行训练。

+ 它在推理过程中提供战略利益，从而导致更成功的谈判；
+ 它可以通过改变温度参数灵活调整对ToM预测的依赖程度；
+ 它利用文本话语推断对手的类型，从而捕获有用但标准对话框状态转换中缺少的旁侧信息（例如，情绪）。

## 2. 方法

### 2.1 任务

我们考虑一个面向任务的对话设置，其中有两个代理，一个买方和一个卖方。

买家的目标是以最低的成本购买列出的物品，卖家的目标是以尽可能高的价格出售物品。 项目描述对两个代理都是公开的，而目标价格对买方和卖方都是私有的。 两个代理人轮流谈判，直到他们达成一致或不同。

![image-20210731125704808](https://gitee.com/cao-hu/pictures/raw/master/img/image-20210731125704808.png)

### 2.2 模型

![image-20210731130246362](https://gitee.com/cao-hu/pictures/raw/master/img/image-20210731130246362.png)

心智理论 (ToM) 谈判系统框架。 买方和卖方之间的交互可以分为三个层次：话语层次、对话行为层次和状态层次。 parser从输入话语中提取意图和关键信息（例如，价格）作为对话行为。 意图和关键信息以及上下文（例如关于项目的描述）都有助于对话的状态。 传统的基于 RL 的对话管理器根据当前状态决定对话行为。 并且生成器将抽象对话行为转换回自然语言话语，同样基于先前的状态。 一阶ToM模型明确预测了对手的回复和状态转换，支持更多的战略谈判。

## 备注

**例子**

![image-20210731130632738](https://gitee.com/cao-hu/pictures/raw/master/img/image-20210731130632738.png)