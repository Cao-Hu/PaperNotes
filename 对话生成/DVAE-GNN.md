# 【论文阅读】**Discovering Dialog Structure Graph for Coherent Dialog Generation**

ACL 2021

发现用于连贯对话生成的对话结构图

论文链接：https://aclanthology.org/2021.acl-long.136.pdf

## 1. 简介

**背景：**

很难将单独的话语组织成全局连贯的流。可能的原因是在没有对话结构背景知识的情况下很难控制整个对话流程（Dialog structure，对话结构指对话状态和它们之间的转移）。手动注释对话结构既费力又费钱，以无监督的方式从语料库中发现开放域对话结构对于连贯对话的生成具有重要意义。

一些研究试图从面向任务的对话中发现对话结构。 然而，它们的对话状态的数量仅限于几十个或数百个，无法涵盖开放域对话中的细粒度语义。 此外，他们发现的对话结构通常只包含句子级语义（非分层），没有会话级语义（聊天主题），这在开放域对话中是必不可少的。因此，为了提供开放域对话结构的全貌，需要发现一个两层有向图，在上层顶点中包含会话级语义 ，低层顶点中的句子级语义，以及这些顶点之间的边。

**本文工作**：

在本文中，我们提出了一种具有图神经网络的新型离散变分自动编码器（DVAE-GNN），以从聊天语料库中发现两层对话结构。 直观地说，由于离散对话状态更容易捕获对话连贯性的转换，因此在大多数基于 VAE 的对话模型中，我们使用离散变量来表示对话状态（或图中的顶点）而不是密集连续的状态。 具体来说，我们使用一个带有 softmax 函数的 RNN 编码器作为 DVAE 中的顶点识别模块，使用一个 RNN 解码器作为 DVAE 中的重建模块。此外，我们将 GNN 集成到 DVAE 中以对离散变量之间的复杂关系进行建模，以更有效 发现。  DVAE-GNN 的参数可以通过最小化重建损失来优化，而不需要任何带注释的数据集。

![image-20210801150205845](https://gitee.com/cao-hu/pictures/raw/master/img/image-20210801150205845.png)

如图 1 所示，使用训练好的 DVAE-GNN，我们分三步构建对话结构图。 首先，我们将所有对话会话映射到句子级和会话级顶点，如图 1 (b) 所示； 其次，我们计算所有对话会话的映射顶点的共现统计，如图1（c）所示。最后，我们根据收集到的所有共现统计在顶点之间建立边，形成对话结构图，如图1（c）所示。

![image-20210801150639998](https://gitee.com/cao-hu/pictures/raw/master/img/image-20210801150639998.png)

为了证明所发现结构的有效性，我们提出了一种基于分层强化学习 (RL) 的基于图的对话系统 (GCS)，以利用它进行对话生成。 如图 2 所示，给定一个对话上下文，GCS 首先将其映射到一个句子级别的顶点，然后学习遍历图边，最后选择一个上下文合适的句子级别的顶点来指导每一轮的回复生成。

## 2. 方法

![image-20210801151144751](https://gitee.com/cao-hu/pictures/raw/master/img/image-20210801151144751.png)

## 3. Case Study

![image-20210801151637925](https://gitee.com/cao-hu/pictures/raw/master/img/image-20210801151637925.png)